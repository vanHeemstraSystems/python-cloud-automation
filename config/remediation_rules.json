{
  "rules": [
    {
      "resource_type": "*",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "ManagedBy": "Automation",
        "ComplianceCheck": "Required"
      },
      "enabled": true,
      "description": "Default rule for all resource types - applies basic tags when missing"
    },
    {
      "resource_type": "Microsoft.Compute/virtualMachines",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "CostCenter": "Unassigned",
        "Owner": "Unassigned",
        "BackupRequired": "Yes",
        "AutoShutdown": "Enabled"
      },
      "enabled": true,
      "description": "Virtual machines get additional default tags including backup requirement"
    },
    {
      "resource_type": "Microsoft.Storage/storageAccounts",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "CostCenter": "Unassigned",
        "Owner": "Unassigned",
        "DataClassification": "Internal",
        "EncryptionEnabled": "Yes"
      },
      "enabled": true,
      "description": "Storage accounts include data classification and encryption tags"
    },
    {
      "resource_type": "Microsoft.Sql/servers",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "CostCenter": "Unassigned",
        "Owner": "Unassigned",
        "DataClassification": "Confidential",
        "BackupRequired": "Yes",
        "ComplianceScope": "GDPR"
      },
      "enabled": true,
      "description": "SQL servers require elevated data classification and compliance tags"
    },
    {
      "resource_type": "Microsoft.Network/networkSecurityGroups",
      "action": "notify_only",
      "default_tags": {},
      "enabled": true,
      "description": "NSGs only trigger notifications, no auto-remediation to avoid security policy conflicts"
    },
    {
      "resource_type": "Microsoft.KeyVault/vaults",
      "action": "notify_only",
      "default_tags": {},
      "enabled": true,
      "description": "Key Vaults only trigger notifications, no auto-remediation for security reasons"
    },
    {
      "resource_type": "Microsoft.ContainerService/managedClusters",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "CostCenter": "Unassigned",
        "Owner": "Unassigned",
        "Criticality": "High",
        "BackupRequired": "Yes"
      },
      "enabled": true,
      "description": "AKS clusters default to high criticality due to typically running production workloads"
    },
    {
      "resource_type": "Microsoft.Web/sites",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "CostCenter": "Unassigned",
        "Owner": "Unassigned",
        "Criticality": "Medium"
      },
      "enabled": true,
      "description": "App Services and Web Apps get medium criticality by default"
    },
    {
      "resource_type": "Microsoft.Network/publicIPAddresses",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "Owner": "Unassigned",
        "ExposureLevel": "Public",
        "SecurityReview": "Required"
      },
      "enabled": true,
      "description": "Public IPs flagged for security review due to internet exposure"
    },
    {
      "resource_type": "Microsoft.Compute/disks",
      "action": "add_tags",
      "default_tags": {
        "Environment": "Unknown",
        "Owner": "Unassigned",
        "EncryptionEnabled": "Yes",
        "OrphanCheck": "Required"
      },
      "enabled": true,
      "description": "Managed disks include orphan check to identify unattached disks for cost optimization"
    }
  ],
  "remediation_settings": {
    "max_resources_per_batch": 100,
    "retry_attempts": 3,
    "retry_delay_seconds": 5,
    "enable_dry_run": false,
    "notification_threshold": 10,
    "auto_remediation_enabled": false
  },
  "metadata": {
    "version": "1.0",
    "last_updated": "2026-01-01",
    "description": "Auto-remediation rules for Azure resource tagging compliance"
  }
}
